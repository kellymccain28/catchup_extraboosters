# Function to add intervention labels and to add age group label

add_labels <- function(df){
  out <- df %>%
    # mutate(age_grp = paste0(age_lower, '-', age_upper)) %>%
    # mutate(age_grp = factor(age_grp, levels = c('0-0.5', '0.5-1', '1-1.5', '1.5-2', '2-2.5', '2.5-3', '3-3.5', '3.5-4', '4-4.5', '4.5-5', '5-5.5', '5.5-6', 
    #                                             '6-6.5', '6.5-7', '7-7.5', '7.5-8', '8-8.5', '8.5-9', '9-9.5', '9.5-10', '10-10.5', '10.5-11', '11-11.5', 
    #                                             '11.5-12', '12-12.5', '12.5-13', '13-13.5', '13.5-14', '14-14.5', '14.5-15', '15-15.5', '15.5-16', '16-16.5',
    #                                             '16.5-17', '17-17.5', '17.5-18', '18-18.5', '18.5-19', '19-19.5', '19.5-20', '20-20.5', '20.5-21', '21-21.5',
    #                                             '21.5-22', '22-22.5', '22.5-23', '23-23.5', '23.5-24', '24-24.5', '24.5-25', '25-25.5', '25.5-26', '26-26.5', 
    #                                             '26.5-27', '27-27.5', '27.5-28', '28-28.5', '28.5-29', '29-29.5', '29.5-30', '30-30.5', '30.5-31', '31-31.5', 
    #                                             '31.5-32', '32-32.5', '32.5-33', '33-33.5', '33.5-34', '34-34.5', '34.5-35', '35-35.5', '35.5-36', '36-36.5', 
    #                                             '36.5-37', '37-37.5', '37.5-38', '38-38.5', '38.5-39', '39-39.5', '39.5-40', '40-40.5', '40.5-41', '41-41.5', 
    #                                             '41.5-42', '42-42.5', '42.5-43', '43-43.5', '43.5-44', '44-44.5', '44.5-45', '45-45.5', '45.5-46', '46-46.5', 
    #                                             '46.5-47', '47-100',
    #                                             '0-5','5-10','10-15','0-100'))) %>%
    mutate(strategytype = ifelse(PEVstrategy == "AB" | PEVstrategy == 'hybrid' | PEVstrategy == 'SV', 'Routine',
                                 ifelse(PEVstrategy == 'catch-up', 'Catch-up',
                                        ifelse(PEVstrategy == 'mass', 'Mass',
                                               ifelse(PEVstrategy == 'none','No vaccine', NA))))) %>%
    mutate(label_int = paste(PEVstrategy, PEVage, PEVrounds, EPIbooster, EPIextra, massbooster_rep),
           labels = case_when(label_int == "AB - - 12m - -"  ~ 'Routine age-based',
                              label_int == "AB - - 12m boost - -"  ~ '12m booster with higher titre',
                              label_int == "AB - - 18m - -" ~ '18m booster',
                              label_int == "AB - - 12m 10y -" ~ "10y booster",
                              label_int == 'AB - - 12m 5y -' ~ "5y booster",
                              label_int == 'AB - - 12m 2y -' ~ "2y booster",
                              label_int == 'AB - - 12m 5y+10y -' ~ "5y, 10y boosters",
                              label_int == 'AB - - 12m 2y+10y -' ~ "2y, 10y boosters",
                              label_int == 'AB - - 12m 2y+5y -' ~ "2y, 5y boosters",
                              label_int == 'AB - - 12m 2y+5y+10y -' ~ "2y, 5y, 10y boosters",
                              label_int == 'SV - - seasonal - -' ~ 'Seasonal vaccination',
                              label_int == 'hybrid - - seasonal - -' ~ 'Hybrid vaccination',
                              label_int == 'catch-up 5-14 - 12m boost - -' | label_int == 'catch-up 5-14 - 12m - -' ~ '5-14y',
                              label_int == 'catch-up 5-14 - 12m boost 10y -' | label_int == 'catch-up 5-14 - 12m 10y -' ~ '5-14y;\n10y booster',
                              label_int == 'catch-up 5-14 - 12m boost 5y -' | label_int == 'catch-up 5-14 - 12m 5y -' ~ '5-14y;\n5y booster',
                              label_int == 'catch-up 5-14 - 12m boost 2y -' | label_int == 'catch-up 5-14 - 12m 2y -' ~ '5-14y;\n2y booster',
                              label_int == 'catch-up 5-14 - 12m boost 5y+10y -' | label_int == 'catch-up 5-14 - 12m 5y+10y -' ~ '5-14y;\n5y, 10y boosters',
                              label_int == 'catch-up 5-14 - 12m boost 2y+10y -' | label_int == 'catch-up 5-14 - 12m 2y+10y -' ~ '5-14y;\n2y, 10y boosters',
                              label_int == 'catch-up 5-14 - 12m boost 2y+5y -' | label_int == 'catch-up 5-14 - 12m 2y+5y -' ~ '5-14y;\n2y, 5y boosters',
                              label_int == 'catch-up 5-14 - 12m boost 2y+5y+10y -' | label_int == 'catch-up 5-14 - 12m 2y+5y+10y -' ~ '5-14y;\n2y, 5y, 10y boosters',
                              label_int == 'catch-up 5-9 - 12m boost - -' | label_int == 'catch-up 5-9 - 12m - -' ~ '5-9y',
                              label_int == 'catch-up 5-9 - 12m boost 10y -' | label_int == 'catch-up 5-9 - 12m 10y -' ~ '5-9y;\n10y booster',
                              label_int == 'catch-up 5-9 - 12m boost 5y -' | label_int == 'catch-up 5-9 - 12m 5y -' ~ '5-9y;\n5y booster',
                              label_int == 'catch-up 5-9 - 12m boost 2y -' | label_int == 'catch-up 5-9 - 12m 2y -' ~ '5-9y;\n2y booster',
                              label_int == 'catch-up 5-9 - 12m boost 5y+10y -' | label_int == 'catch-up 5-9 - 12m 5y+10y -' ~ '5-9y;\n5y, 10y boosters',
                              label_int == 'catch-up 5-9 - 12m boost 2y+10y -' | label_int == 'catch-up 5-9 - 12m 2y+10y -' ~ '5-9y;\n2y, 10y boosters',
                              label_int == 'catch-up 5-9 - 12m boost 2y+5y -' | label_int == 'catch-up 5-9 - 12m 2y+5y -' ~ '5-9y;\n2y, 5y boosters',
                              label_int == 'catch-up 5-9 - 12m boost 2y+5y+10y -' | label_int == 'catch-up 5-9 - 12m 2y+5y+10y -' ~ '5-9y;\n2y, 5y, 10y boosters',
                              label_int == 'catch-up 6m-14y - 12m - -' ~ '6m-14y',
                              label_int == 'catch-up 6m-14y - 12m 10y -' ~ '6m-14y;\n10y booster',
                              label_int == 'catch-up 6m-14y - 12m 2y -' ~ '6m-14y;\n2y booster',
                              label_int == 'catch-up 6m-14y - 12m 5y -' ~ '6m-14y;\n5y booster',
                              label_int == 'catch-up 6m-14y - 12m 5y+10y -' ~ '6m-14y;\n5y, 10y boosters',
                              label_int == 'catch-up 6m-14y - 12m 2y+5y -' ~ '6m-14y;\n2y, 5y boosters',
                              label_int == 'catch-up 6m-14y - 12m 2y+10y -' ~ '6m-14y;\n2y, 10y boosters',
                              label_int == 'catch-up 6m-14y - 12m 2y+5y+10y -' ~ '6m-14y;\n2y, 5y, 10y boosters',
                              label_int == 'catch-up 6m-2y - 12m - -' ~ '6m-2y',
                              label_int == 'catch-up 6m-2y - 12m 10y -' ~ '6m-2y;\n10y booster',
                              label_int == 'catch-up 6m-2y - 12m 5y -' ~ '6m-2y;\n5y booster',
                              label_int == 'catch-up 6m-2y - 12m 2y -' ~ '6m-2y;\n2y booster',
                              label_int == 'catch-up 6m-2y - 12m 5y+10y -' ~ '6m-2y;\n5y, 10y boosters',
                              label_int == 'catch-up 6m-2y - 12m 2y+5y -' ~ '6m-2y;\n2y, 5y boosters',
                              label_int == 'catch-up 6m-2y - 12m 2y+10y -' ~ '6m-2y;\n2y, 10y boosters',
                              label_int == 'catch-up 6m-2y - 12m 2y+5y+10y -' ~ '6m-2y;\n2y, 5y, 10y boosters',
                              label_int == 'catch-up 6m-4y - 12m - -' ~ '6m-4y',
                              label_int == 'catch-up 6m-4y - 12m 10y -' ~ '6m-4y;\n10y booster',
                              label_int == 'catch-up 6m-4y - 12m 5y -' ~ '6m-4y;\n5y booster',
                              label_int == 'catch-up 6m-4y - 12m 2y -' ~ '6m-4y;\n2y booster',
                              label_int == 'catch-up 6m-4y - 12m 5y+10y -' ~ '6m-4y;\n5y, 10y boosters',
                              label_int == 'catch-up 6m-4y - 12m 2y+5y -' ~ '6m-4y;\n2y, 5y boosters',
                              label_int == 'catch-up 6m-4y - 12m 2y+10y -' ~ '6m-4y;\n2y, 10y boosters',
                              label_int == 'catch-up 6m-4y - 12m 2y+5y+10y -' ~ '6m-4y;\n2y, 5y, 10y boosters',
                              label_int == 'catch-up 6m-9y - 12m - -' ~ '6m-9y',
                              label_int == 'catch-up 6m-9y - 12m 10y -' ~ '6m-9y;\n10y booster',
                              label_int == 'catch-up 6m-9y - 12m 5y -' ~ '6m-9y;\n5y booster',
                              label_int == 'catch-up 6m-9y - 12m 2y -' ~ '6m-9y;\n2y booster',
                              label_int == 'catch-up 6m-9y - 12m 5y+10y -' ~ '6m-9y;\n5y, 10y boosters',
                              label_int == 'catch-up 6m-9y - 12m 2y+5y -' ~ '6m-9y;\n2y, 5y boosters',
                              label_int == 'catch-up 6m-9y - 12m 2y+10y -' ~ '6m-9y;\n2y, 10y boosters',
                              label_int == 'catch-up 6m-9y - 12m 2y+5y+10y -' ~ '6m-9y;\n2y, 5y, 10y boosters',
                              label_int == 'none - - - - -' ~ 'None'),
           labels = factor(labels, levels = c('Routine age-based', "2y booster","5y booster", "10y booster","5y, 10y boosters",
                                              '2y, 5y boosters','2y, 10y boosters', '2y, 5y, 10y boosters',
                                              'Seasonal vaccination', 'Hybrid vaccination',
                                              '6m-2y', '6m-2y;\n2y booster', '6m-2y;\n5y booster', '6m-2y;\n10y booster', '6m-2y;\n5y, 10y boosters','6m-2y;\n2y, 5y boosters','6m-2y;\n2y, 10y boosters','6m-2y;\n2y, 5y, 10y boosters',
                                              '6m-4y', '6m-4y;\n2y booster', '6m-4y;\n5y booster', '6m-4y;\n10y booster', '6m-4y;\n5y, 10y boosters','6m-4y;\n2y, 5y boosters','6m-4y;\n2y, 10y boosters','6m-4y;\n2y, 5y, 10y boosters',
                                              '6m-9y', '6m-9y;\n2y booster', '6m-9y;\n5y booster', '6m-9y;\n10y booster', '6m-9y;\n5y, 10y boosters','6m-9y;\n2y, 5y boosters','6m-9y;\n2y, 10y boosters','6m-9y;\n2y, 5y, 10y boosters',
                                              '6m-14y', '6m-14y;\n2y booster', '6m-14y;\n5y booster', '6m-14y;\n10y booster', '6m-14y;\n5y, 10y boosters','6m-14y;\n2y, 5y boosters','6m-14y;\n2y, 10y boosters','6m-14y;\n2y, 5y, 10y boosters',
                                              '5-9y', '5-9y;\n2y booster', '5-9y;\n5y booster', '5-9y;\n10y booster', '5-9y;\n5y, 10y boosters','5-9y;\n2y, 5y boosters','5-9y;\n2y, 10y boosters','5-9y;\n2y, 5y, 10y boosters',
                                              '5-14y', '5-14y;\n2y booster', '5-14y;\n5y booster', '5-14y;\n10y booster', '5-14y;\n5y, 10y boosters','5-14y;\n2y, 5y boosters','5-14y;\n2y, 10y boosters','5-14y;\n2y, 5y, 10y boosters',
                                              'None')),
           EPIextra_labels = case_when(EPIextra == '-'~ '12m only', 
                                       EPIextra == '5y' ~ '12m + 5y',
                                       EPIextra == '2y' ~ '12m + 2y',
                                       EPIextra == '10y'~ '12m + 10y',
                                       EPIextra == '5y+10y' ~ "12m + 5y + 10y",
                                       EPIextra == '2y+5y' ~ '12m + 2y + 5y',
                                       EPIextra == '2y+10y' ~ '12m + 2y + 10y',
                                       EPIextra == '2y+5y+10y' ~ '12m + 2y + 5y + 10y'),
           EPIextra_labels = factor(EPIextra_labels, levels = c('12m only', '12m + 2y', '12m + 5y', '12m + 10y', '12m + 5y + 10y','12m + 2y + 5y','12m + 2y + 10y','12m + 2y + 5y + 10y')),
           scen_labels = case_when(EPIextra == '-' & PEVstrategy == 'catch-up' ~ 'Catch-up with \n12m AB booster',
                                   EPIextra == '-' & PEVstrategy == 'AB' ~ 'Routine only',
                                   EPIextra == '5y' & PEVstrategy == 'catch-up'~ 'Catch-up with \n12m, 5y AB boosters',
                                   EPIextra == '2y' & PEVstrategy == 'catch-up'~ 'Catch-up with \n12m, 2y AB boosters',
                                   EPIextra == '10y'& PEVstrategy == 'catch-up' ~ 'Catch-up with \n12m, 10y AB boosters',
                                   EPIextra == '5y+10y' & PEVstrategy == 'catch-up'~ 'Catch-up with \n12m, 5y, 10y AB boosters',
                                   EPIextra == '2y+10y' & PEVstrategy == 'catch-up'~ 'Catch-up with \n12m, 2y, 10y AB boosters',
                                   EPIextra == '2y+5y' & PEVstrategy == 'catch-up'~ 'Catch-up with \n12m, 2y, 5y AB boosters',
                                   EPIextra == '2y+5y+10y' & PEVstrategy == 'catch-up'~ 'Catch-up with \n12m, 2y, 5y, 10y AB boosters'),
           scen_labels = factor(scen_labels, levels = c('Routine only','Catch-up with \n12m AB booster','Catch-up with \n12m, 2y AB boosters', 'Catch-up with \n12m, 5y AB boosters',
                                                        'Catch-up with \n12m, 10y AB boosters','Catch-up with \n12m, 2y, 10y AB boosters','Catch-up with \n12m, 2y, 5y AB boosters',
                                                        'Catch-up with \n12m, 2y, 5y, 10y AB boosters')))
  
  return(out)
}
